<header class="sticky top-0 z-50 bg-white/80 backdrop-blur-md border-b border-solid border-slate-200 transition-all duration-300">
    <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex justify-between items-center h-20">

            <div class="flex items-center">

                @* Burger Icon For Small Screens *@
                <button id="mobileMenuBtn" class="lg:hidden mr-3 p-2 text-gray-500 hover:bg-gray-100 rounded-xl transition-all duration-200 hover:text-[#345e69]">
                    <svg class="h-8 w-8" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h8m-8 6h16" />
                    </svg>
                </button>

                @* Logo Icon*@
                @* <div class="flex-shrink-0 flex items-center group cursor-pointer"> *@
                <a asp-controller="Home" asp-action="Index" class="flex-shrink-0 flex items-center group cursor-pointer">
                    <div class="bg-[#345e69] w-10 h-10 flex items-center justify-center rounded-xl shadow-lg group-hover:rotate-12 group-hover:scale-110 transition-all duration-300 ease-in-out">
                        <span class="text-white text-2xl font-black">S</span>
                    </div>

                    <span class="ml-3 text-2xl font-black tracking-tighter bg-gradient-to-r from-[#345e69] via-[#345e69] via-[20%] to-[#4a8291] bg-[length:200%_auto] hover:bg-right transition-all duration-300 bg-clip-text text-transparent hidden md:block">
                        SOHBA
                    </span>
                @* </div> *@
                </a>

            </div>

            @* Search Bar*@
            <div class="flex-1 max-w-md mx-8 hidden sm:block">
                <div class="relative group">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="h-5 w-5 text-gray-400 group-focus-within:text-[#345e69] transition-colors duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                    <input type="text"
                           class="block w-full pl-10 pr-3 py-2 border border-solid border-gray-200 rounded-2xl bg-gray-50 leading-5 placeholder-gray-400
                      transition-all duration-300 ease-out
                      focus:outline-none focus:bg-white focus:ring-2 focus:ring-[#345e69]/20 focus:border-[#345e69]
                      focus:scale-[1.02] focus:shadow-[0_4px_20px_-4px_rgba(52,94,105,0.15)] origin-center sm:text-sm"
                           placeholder="ابحث في صحبة...">
                </div>
            </div>

            <div class="flex items-center space-x-2 md:space-x-5">

                @* Search Icon On Mobile Screen*@
                <button id="mobileSearchBtn" class="sm:hidden p-2 text-gray-500 hover:bg-gray-100 rounded-xl transition-all duration-200 hover:text-[#345e69] active:scale-90">
                    <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                    </svg>
                </button>


                @* Notification Section with Dropdown *@
                <div class="relative">
                    @* Notification Icon *@
                    <button id="notifBtn" class="relative p-2 text-gray-500 hover:bg-gray-100 rounded-xl transition-all duration-200 hover:text-[#345e69] active:scale-90">
                        <span class="absolute top-2 right-2.5 block h-2.5 w-2.5 rounded-full bg-red-500 ring-2 ring-white animate-pulse"></span>
                        <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9" />
                        </svg>
                    </button>

                    @* Notifications Dropdown *@
                    <div id="notifDropdown" class="hidden absolute right-0 mt-3 w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 z-[60] overflow-hidden transform origin-top-right transition-all duration-200">
                        <div class="px-4 py-3 border-b border-gray-50 flex justify-between items-center bg-gray-50/50">
                            <span class="font-bold text-gray-800">الإشعارات</span>
                            <span class="text-xs text-[#345e69] cursor-pointer hover:underline">تحديد الكل كقروء</span>
                        </div>

                        @* Notifications List *@
                        <div class="max-h-[400px] overflow-y-auto">
                            @* Sample Notification Item (كرر هذا الجزء 10 مرات أو استخدم Loop) *@
                            @* This Code Will use For One Item When I Send Them From DB -- So Don't Remove The Item (For lOOP) To Get The Style*@
                            @for (int i = 0; i < 5; i++)
                            {
                                <a href="#" class="flex items-start px-4 py-3 hover:bg-gray-50 border-b border-gray-50 transition-colors">
                                    <div class="flex-shrink-0">
                                        <img class="h-10 w-10 rounded-full object-cover" src="https://ui-avatars.com/api/?name=User&background=345e69&color=fff" alt="">
                                    </div>
                                    <div class="ml-3">
                                        <p class="text-sm text-gray-600 leading-tight">
                                            <span class="font-bold text-gray-900">أحمد محمد</span> قام بالتعليق على منشورك الأخير.
                                        </p>
                                        <span class="text-[11px] text-gray-400 mt-1 block">منذ 5 دقائق</span>
                                    </div>
                                </a>
                            }
                        </div>

                        @* Footer *@
                        <a asp-controller="Notifications" asp-action="Index" class="block py-3 text-center text-sm font-bold text-[#345e69] bg-gray-50 hover:bg-gray-100 transition-colors border-t border-gray-100">
                            See All Notifications
                        </a>
                    </div>
                </div>

                @* Profile Picture Section With Dropdown *@
                <div class="relative group cursor-pointer">
                    <div id="profileBtn" class="p-0.5 rounded-full bg-gradient-to-tr from-[#345e69] to-indigo-400 hover:scale-110 transition-transform duration-300">
                        <img class="h-9 w-9 rounded-full object-cover border-2 border-white"
                             src="https://ui-avatars.com/api/?name=User&background=345e69&color=fff"
                             alt="User profile">
                    </div>
                    <span class="absolute bottom-0 right-0 block h-3 w-3 rounded-full bg-green-500 ring-2 ring-white"></span>

                    <div id="profileDropdown" class="hidden absolute right-0 mt-3 w-64 bg-white rounded-2xl shadow-2xl border border-gray-100 z-[70] overflow-hidden transform origin-top-right transition-all duration-200">

                        <div class="p-5 text-center bg-gray-50/50 border-b border-gray-50">
                            <div class="relative inline-block">
                                <img class="h-16 w-16 rounded-2xl object-cover border-2 border-white shadow-md mx-auto"
                                     src="https://ui-avatars.com/api/?name=User&background=345e69&color=fff" alt="User big avatar">
                                <span class="absolute -bottom-1 -right-1 block h-4 w-4 rounded-full bg-green-500 ring-2 ring-white"></span>
                            </div>
                            <h4 class="mt-3 font-black text-gray-900 leading-none">اسم المستخدم هنا</h4>
                            <p class="text-xs text-gray-500 mt-1">user@email.com</p>
                        </div>

                        <div class="p-2">
                            @* <a href="#" class="flex items-center justify-between px-4 py-3 text-sm text-gray-700 hover:bg-[#345e69]/5 hover:text-[#345e69] rounded-xl transition-colors group/item">
                                <div class="flex items-center">
                                    <svg class="h-5 w-5 mr-3 text-gray-400 group-hover/item:text-[#345e69]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                    <span class="font-bold">My Account</span>
                                </div>
                                <svg class="h-4 w-4 text-gray-400 group-hover/item:rotate-90 transition-transform duration-300" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                            </a> *@

                            @* <hr class="my-2 border-gray-50">
                            <a href="#" class="flex items-center px-4 py-3 text-sm text-red-600 hover:bg-red-50 rounded-xl transition-colors font-bold group/logout">
                                <svg class="h-5 w-5 mr-3 text-red-400 group-hover/logout:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                </svg>
                                Logout
                            </a> *@


                            <a asp-controller="Profile" asp-action="Index" class="flex items-center justify-between px-4 py-3 text-sm text-gray-700 hover:bg-[#345e69]/5 hover:text-[#345e69] rounded-xl transition-colors group/item">
                                <div class="flex items-center">
                                    <svg class="h-5 w-5 mr-3 text-gray-400 group-hover/item:text-[#345e69]" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z" />
                                    </svg>
                                    <span class="font-bold">My Account</span>
                                </div>
                            </a>

                            <!-- ✅ أضيف Settings: -->
                            <a asp-controller="Profile" asp-action="Edit" class="flex items-center px-4 py-3 text-sm text-gray-700 hover:bg-[#345e69]/5 hover:text-[#345e69] rounded-xl transition-colors">
                                <svg class="h-5 w-5 mr-3 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" />
                                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" />
                                </svg>
                                <span class="font-bold">Settings</span>
                            </a>

                            <!-- ✅ Logout خليه Form: -->
                            <form asp-controller="Auth" asp-action="Logout" method="post" class="block">
                                <button type="submit" class="w-full flex items-center px-4 py-3 text-sm text-red-600 hover:bg-red-50 rounded-xl transition-colors font-bold group/logout text-left">
                                    <svg class="h-5 w-5 mr-3 text-red-400 group-hover/logout:translate-x-1 transition-transform" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 16l4-4m0 0l-4-4m4 4H7m6 4v1a3 3 0 01-3 3H6a3 3 0 01-3-3V7a3 3 0 013-3h4a3 3 0 013 3v1" />
                                    </svg>
                                    Logout
                                </button>
                            </form>
                        </div>
                    </div>
                </div>

            </div>
        </div>

        @* Search Input On Mobile Screen *@
        <div id="mobileSearchContainer"
             class="max-h-0 opacity-0 overflow-hidden transition-all duration-300 ease-in-out sm:hidden bg-white/50 backdrop-blur-sm border-t border-transparent">

            <div class="px-4 pb-4 pt-2">
                <div class="relative">
                    <div class="absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none">
                        <svg class="h-5 w-5 text-gray-400" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
                        </svg>
                    </div>
                    <input type="text"
                           class="block w-full pl-10 pr-3 py-2 border border-solid border-gray-200 rounded-xl bg-gray-50
                          focus:outline-none focus:bg-white focus:ring-2 focus:ring-[#345e69] focus:border-transparent transition-all duration-300"
                           placeholder="ابحث...">
                </div>
            </div>
        </div>

    </div>
</header>






@* JavaScript Code For Header : *@

<script>
    document.addEventListener('DOMContentLoaded', function () {

        // Mobile Search
        const searchBtn = document.getElementById('mobileSearchBtn');
        const searchContainer = document.getElementById('mobileSearchContainer');

        if (searchBtn && searchContainer) {
            searchBtn.addEventListener('click', function () {
                const isClosed = searchContainer.classList.contains('max-h-0');

                searchContainer.classList.toggle('max-h-0', !isClosed);
                searchContainer.classList.toggle('opacity-0', !isClosed);
                searchContainer.classList.toggle('border-transparent', !isClosed);

                searchContainer.classList.toggle('max-h-40', isClosed);
                searchContainer.classList.toggle('opacity-100', isClosed);
                searchContainer.classList.toggle('border-slate-100', isClosed);

                if (isClosed) {
                    setTimeout(() => searchContainer.querySelector('input')?.focus(), 100);
                }
            });
        }

        // Notifications
        const notifBtn = document.getElementById('notifBtn');
        const notifDropdown = document.getElementById('notifDropdown');

        if (notifBtn && notifDropdown) {
            notifBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                notifDropdown.classList.toggle('hidden');
            });

            document.addEventListener('click', function (e) {
                if (!notifDropdown.contains(e.target) && !notifBtn.contains(e.target)) {
                    notifDropdown.classList.add('hidden');
                }
            });
        }

        // Profile
        const profileBtn = document.getElementById('profileBtn');
        const profileDropdown = document.getElementById('profileDropdown');

        if (profileBtn && profileDropdown) {
            profileBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                profileDropdown.classList.toggle('hidden');
                notifDropdown?.classList.add('hidden');
            });

            document.addEventListener('click', function () {
                profileDropdown.classList.add('hidden');
            });
        }

        // Burger Menu
        const mobileMenuBtn = document.getElementById('mobileMenuBtn');

        if (mobileMenuBtn) {
            mobileMenuBtn.addEventListener('click', function (e) {
                e.stopPropagation();
                toggleSidebar();
            });
        }

    });
</script>