<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Sohba</title>
    <script type="importmap"></script>
    <link href="~/Icon.png" sizes="32x32" rel="icon" type="image/png" />

    @* <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" /> *@
    @* <link rel="stylesheet" href="~/css/tailwind.css" asp-append-version="true" /> *@
    @* <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.min.css" /> *@
    @* <link rel="stylesheet" href="~/Sohba.styles.css" asp-append-version="true" /> *@


    <link rel="stylesheet" href="~/css/site.css" asp-append-version="true" />

    <link rel="stylesheet" href="~/css/tailwind.css" />
    <link rel="stylesheet" href="~/css/legacy.css" />

    <script src="https://cdn.tailwindcss.com"></script>

</head>
<body class="bg-[#f0f2f5] text-slate-800 antialiased selection:bg-[#345e69] selection:text-white ">
    <partial name="Partials/_Header" />
   
    <div class="w-full px-0 sm:px-6 lg:px-8 max-w-[1920px] mx-auto">
        <div class="flex flex-row gap-6 items-start">

            @* Left Sidebar (Partial) - Fixed width *@
            <partial name="Partials/_Sidebar" />

            @* Main Content Wrapper (Dynamic Width) *@
            <main class="flex-1 min-w-0 py-6">
                @RenderBody()
            </main>

        </div>
    </div>



    <script src="~/lib/jquery/dist/jquery.min.js"></script>
    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
    <script src="~/js/site.js" asp-append-version="true"></script>
    
    @await RenderSectionAsync("Scripts", required: false)

    @* TODO: I Will Move It To App.JS File *@
    <script>
                // ==========================================
        // Sohba App - Interactive Features
        // ==========================================

        const SohbaApp = {
            // Toast Notifications
            toast: (message, type = 'info') => {
                const toast = document.createElement('div');
                toast.className = `toast ${type}`;
                toast.innerHTML = `
                    <div class="flex items-center gap-3">
                        <span class="text-${type === 'success' ? 'green' : type === 'error' ? 'red' : 'blue'}-500">
                            ${type === 'success' ? '✓' : type === 'error' ? '✕' : 'ℹ'}
                        </span>
                        <span class="font-semibold text-gray-700">${message}</span>
                    </div>
                `;
                document.body.appendChild(toast);

                requestAnimationFrame(() => toast.classList.add('show'));

                setTimeout(() => {
                    toast.classList.remove('show');
                    setTimeout(() => toast.remove(), 300);
                }, 3000);
            },

            // Like Animation
            animateLike: (button) => {
                button.classList.add('like-animation');
                const icon = button.querySelector('svg');
                icon.classList.add('text-red-500', 'fill-current');
                setTimeout(() => button.classList.remove('like-animation'), 300);
            },

            // AJAX Helper
            post: async (url, data) => {
                const token = document.querySelector('input[name="__RequestVerificationToken"]')?.value;

                try {
                    const response = await fetch(url, {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json',
                            'RequestVerificationToken': token
                        },
                        body: JSON.stringify(data)
                    });

                    return await response.json();
                } catch (error) {
                    console.error('Error:', error);
                    return { success: false, error: 'Network error' };
                }
            },

            // Initialize
            init: () => {
                // Dropdowns
                document.querySelectorAll('[data-dropdown]').forEach(btn => {
                    btn.addEventListener('click', (e) => {
                        e.stopPropagation();
                        const menu = document.getElementById(btn.dataset.dropdown);
                        menu.classList.toggle('hidden');
                    });
                });

                // Close dropdowns on outside click
                document.addEventListener('click', () => {
                    document.querySelectorAll('[id$="Dropdown"]').forEach(el => {
                        if (!el.classList.contains('hidden')) el.classList.add('hidden');
                    });
                });

                // Auto-hide skeletons
                setTimeout(() => {
                    document.querySelectorAll('.skeleton').forEach(el => {
                        el.classList.remove('skeleton');
                    });
                }, 1500);
            }
        };

        // Initialize on DOM ready
        document.addEventListener('DOMContentLoaded', SohbaApp.init);
    </script>
</body>
</html>
